<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>19 Examples and Application Information | LoRa 中文资料汇编</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="LoRa 中文资料汇编。包含 LoRaWAN 1.1 Spec 中文版（翻译）等。持续更新。">
    <link rel="preload" href="/assets/css/0.styles.f1e15b89.css" as="style"><link rel="preload" href="/assets/js/app.741f693f.js" as="script"><link rel="preload" href="/assets/js/2.1bc0aca8.js" as="script"><link rel="preload" href="/assets/js/3.b10d7aa1.js" as="script"><link rel="prefetch" href="/assets/js/10.23e15bef.js"><link rel="prefetch" href="/assets/js/11.a713a811.js"><link rel="prefetch" href="/assets/js/12.2c5eaff8.js"><link rel="prefetch" href="/assets/js/13.3bb3f94d.js"><link rel="prefetch" href="/assets/js/14.e1b9814b.js"><link rel="prefetch" href="/assets/js/15.fe1b5100.js"><link rel="prefetch" href="/assets/js/16.d147badc.js"><link rel="prefetch" href="/assets/js/17.b6bf6b8e.js"><link rel="prefetch" href="/assets/js/18.106ab12b.js"><link rel="prefetch" href="/assets/js/19.9dc7d0a2.js"><link rel="prefetch" href="/assets/js/20.e7085fe8.js"><link rel="prefetch" href="/assets/js/21.82911863.js"><link rel="prefetch" href="/assets/js/22.f46bb411.js"><link rel="prefetch" href="/assets/js/23.f1dc8101.js"><link rel="prefetch" href="/assets/js/24.b81b8f52.js"><link rel="prefetch" href="/assets/js/25.7d1c55c4.js"><link rel="prefetch" href="/assets/js/26.f0bc4c51.js"><link rel="prefetch" href="/assets/js/27.ec545f01.js"><link rel="prefetch" href="/assets/js/28.fc678aa5.js"><link rel="prefetch" href="/assets/js/29.d3d2abd9.js"><link rel="prefetch" href="/assets/js/30.cb8ae1c3.js"><link rel="prefetch" href="/assets/js/31.bae2fa66.js"><link rel="prefetch" href="/assets/js/32.a34e5210.js"><link rel="prefetch" href="/assets/js/33.6c61b41f.js"><link rel="prefetch" href="/assets/js/34.22d3b341.js"><link rel="prefetch" href="/assets/js/35.5937a0a7.js"><link rel="prefetch" href="/assets/js/36.5bcbb7cf.js"><link rel="prefetch" href="/assets/js/37.62d46c8e.js"><link rel="prefetch" href="/assets/js/38.a598cd4c.js"><link rel="prefetch" href="/assets/js/4.ad227c3b.js"><link rel="prefetch" href="/assets/js/5.b8c308d4.js"><link rel="prefetch" href="/assets/js/6.962b3fa9.js"><link rel="prefetch" href="/assets/js/7.45f46359.js"><link rel="prefetch" href="/assets/js/8.5b174735.js"><link rel="prefetch" href="/assets/js/9.2c49762f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f1e15b89.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">LoRa 中文资料汇编</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/deltacat/lora-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/deltacat/lora-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/lorawan-v1.1/" class="sidebar-heading clickable router-link-active"><span>LoRaWAN 1.1 规范</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/lorawan-v1.1/ch01.html" class="sidebar-link">第1章 介绍</a></li><li><a href="/lorawan-v1.1/ch02.html" class="sidebar-link">第2章 LoRaWAN 选型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/lorawan-v1.1/CLASS-A" class="sidebar-heading clickable"><span>CLASS A</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/lorawan-v1.1/ch03.html" class="sidebar-link">第3章 物理消息格式</a></li><li><a href="/lorawan-v1.1/ch04.html" class="sidebar-link">第4章 MAC 帧格式</a></li><li><a href="/lorawan-v1.1/ch05.html" class="sidebar-link">第5章 MAC 指令</a></li><li><a href="/lorawan-v1.1/ch06.html" class="sidebar-link">第6章 终端激活</a></li><li><a href="/lorawan-v1.1/ch07.html" class="sidebar-link">第7章 重传避让</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/lorawan-v1.1/CLASS-B" class="sidebar-heading clickable"><span>CLASS B</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/lorawan-v1.1/ch08.html" class="sidebar-link">第8章 Class B 介绍</a></li><li><a href="/lorawan-v1.1/ch09.html" class="sidebar-link">第9章 下行同步网络的原理</a></li><li><a href="/lorawan-v1.1/ch10.html" class="sidebar-link">第10章 Class B 模式的上行帧</a></li><li><a href="/lorawan-v1.1/ch11.html" class="sidebar-link">第11章 下行 Ping 帧格式（Class B选项）</a></li><li><a href="/lorawan-v1.1/ch12.html" class="sidebar-link">第12章 信标的获得和追踪</a></li><li><a href="/lorawan-v1.1/ch13.html" class="sidebar-link">第13章 Class B下行时隙时序</a></li><li><a href="/lorawan-v1.1/ch14.html" class="sidebar-link">第14章 Class B Mac命令</a></li><li><a href="/lorawan-v1.1/ch15.html" class="sidebar-link">第15章 信标（Class B选项)</a></li><li><a href="/lorawan-v1.1/ch16.html" class="sidebar-link">第16章 Class B 单播/多播下行信道频率</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/lorawan-v1.1/CLASS-C" class="sidebar-heading clickable"><span>CLASS C</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/lorawan-v1.1/ch17.html" class="sidebar-link">第17章 持续接收的终端</a></li><li><a href="/lorawan-v1.1/ch18.html" class="sidebar-link">第18章 Class C MAC 指令</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/lorawan-v1.1/SUPPORT" class="sidebar-heading clickable open"><span>SUPPORT INFORMATION</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/lorawan-v1.1/ch19.html" aria-current="page" class="active sidebar-link">19 Examples and Application Information</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/lorawan-v1.1/ch19.html#_19-1-uplink-timing-diagram-for-confirmed-data-messages" class="sidebar-link">19.1 Uplink Timing Diagram for Confirmed Data Messages</a></li><li class="sidebar-sub-header"><a href="/lorawan-v1.1/ch19.html#_19-2-downlink-diagram-for-confirmed-data-messages" class="sidebar-link">19.2 Downlink Diagram for Confirmed Data Messages</a></li><li class="sidebar-sub-header"><a href="/lorawan-v1.1/ch19.html#downlink-timing-for-frame-pending-messages" class="sidebar-link">Downlink Timing for Frame-Pending Messages</a></li></ul></li><li><a href="/lorawan-v1.1/ch20.html" class="sidebar-link">20 Recommendation on contract to be provided to the Network Server by the end-device provider at the time of provisioning</a></li><li><a href="/lorawan-v1.1/ch21.html" class="sidebar-link">21 Recommendation on finding the locally used channels</a></li><li><a href="/lorawan-v1.1/ch22.html" class="sidebar-link">22 Revisions</a></li><li><a href="/lorawan-v1.1/ch23.html" class="sidebar-link">23 术语表</a></li><li><a href="/lorawan-v1.1/ch24.html" class="sidebar-link">24 Bibliography</a></li><li><a href="/lorawan-v1.1/ch25.html" class="sidebar-link">25 NOTICE OF USE AND DISCLOSURE</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/lorawan-v1.1/appendix" class="sidebar-heading clickable"><span>附录</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_19-examples-and-application-information"><a href="#_19-examples-and-application-information" class="header-anchor">#</a> 19 Examples and Application Information</h1> <p>Examples are illustrations of the LoRaWAN spec for information, but they are not part of the formal specification.</p> <h2 id="_19-1-uplink-timing-diagram-for-confirmed-data-messages"><a href="#_19-1-uplink-timing-diagram-for-confirmed-data-messages" class="header-anchor">#</a> 19.1 Uplink Timing Diagram for Confirmed Data Messages</h2> <p>The following diagram illustrates the steps followed by an end-device trying to transmit two confirmed data frames (Data0 and Data1). This device’s NbTrans parameter must be greater or equal to 2 for this example to be valid (because the first confirmed frame is transmitted twice)</p> <p><img src="/assets/img/15654045834340.e0b6e1ce.jpg" alt=""></p> <p>The end-device first transmits a confirmed data frame containing the Data0 payload at an arbitrary instant and on an arbitrary channel. The frame counter Cu is simply derived by adding 1 to the previous uplink frame counter. The network receives the frame and generates a downlink frame with the ACK bit set exactly RECEIVE_DELAY1 seconds later, using the first receive window of the end-device. This downlink frame uses the same data rate and the same channel as the Data0 uplink. The downlink frame counter Cd is also derived by adding 1 to the last downlink towards that specific end-device. If there is no downlink payload pending the network shall generate a frame without a payload. In this example the frame carrying the ACK bit is not received.</p> <p>If an end-device does not receive a frame with the ACK bit set in one of the two receive windows immediately following the uplink transmission it may resend the same frame with the same payload and frame counter again at least ACK_TIMEOUT seconds after the second reception window. This resend must be done on another channel and must obey the duty cycle limitation as any other normal transmission. If this time the end-device receives the ACK downlink during its first receive window, as soon as the ACK frame is demodulated, the end-device is free to transmit a new frame on a new channel.</p> <p>The third ACK frame in this example also carries an application payload. A downlink frame can carry any combination of ACK, MAC control commands and payload.</p> <h2 id="_19-2-downlink-diagram-for-confirmed-data-messages"><a href="#_19-2-downlink-diagram-for-confirmed-data-messages" class="header-anchor">#</a> 19.2 Downlink Diagram for Confirmed Data Messages</h2> <p>The following diagram illustrates the basic sequence of a “confirmed” downlink.</p> <p><img src="/assets/img/15654048343301.b4ccc353.jpg" alt=""></p> <p>The frame exchange is initiated by the end-device transmitting an “unconfirmed” application payload or any other frame on channel A. The network uses the downlink receive window to transmit a “confirmed” data frame towards the end-device on the same channel A. Upon reception of this data frame requiring an acknowledgement, the end-device transmits a frame with the ACK bit set at its own discretion. This frame might also contain piggybacked data or MAC commands as its payload. This ACK uplink is treated like any standard uplink, and as such is transmitted on a random channel that might be different from channel A.</p> <blockquote><p>Note: To allow the end-devices to be as simple as possible and have keep as few states as possible it may transmit an explicit (possibly empty) acknowledgement data message immediately after the reception of a data message requiring an acknowledgment. Alternatively the end-device may defer the transmission of an acknowledgement to piggyback it with its next data message.</p></blockquote> <h2 id="downlink-timing-for-frame-pending-messages"><a href="#downlink-timing-for-frame-pending-messages" class="header-anchor">#</a> Downlink Timing for Frame-Pending Messages</h2> <p>The next diagram illustrates the use of the <strong>frame pending</strong> (FPending) bit on a downlink. The FPending bit can only be set on a downlink frame and informs the end-device that the network has several frames pending for him; the bit is ignored for all uplink frames.</p> <p>If a frame with the FPending bit set requires an acknowledgement, the end-device shall do so as described before. If no acknowledgment is required, the end-device may send an empty data message to open additional receive windows at its own discretion, or wait until it has some data to transmit itself and open receive windows as usual.</p> <blockquote><p>Note: The FPending bit is independent to the acknowledgment scheme.</p></blockquote> <p>(*) F_P means ‘frame pending’ bit set</p> <p><img src="/assets/img/15654051604240.d2a29ac0.jpg" alt=""></p> <p>In this example the network has two confirmed data frames to transmit to the end-device. The frame exchange is initiated by the end-device via a normal “unconfirmed” uplink message on channel A. The network uses the first receive window to transmit the Data0 with the bit FPending set as a confirmed data message. The device acknowledges the reception of the frame by transmitting back an empty frame with the ACK bit set on a new channel B. RECEIVE_DELAY1 seconds later, the network transmits the second frame Data1 on channel B, again using a confirmed data message but with the FPending bit cleared. The end-device acknowledges on channel C.</p> <p><img src="/assets/img/15654051985337.40b57403.jpg" alt=""></p> <p>In this example, the downlink frames are “unconfirmed” frames, the end-device does not need to send back and acknowledge. Receiving the Data0 unconfirmed frame with the FPending bit set the end-device sends an empty data frame. This first uplink is not received by the network. If no downlink is received during the two receive windows, the network has to wait for the next spontaneous uplink of the end-device to retry the transfer. The end-device can speed up the procedure by sending a new empty data frame.</p> <blockquote><p>Note: An acknowledgement is never sent twice.</p></blockquote> <p>The FPending bit, the ACK bit, and payload data can all be present in the same downlink. For example, the following frame exchange is perfectly valid.</p> <p><img src="/assets/img/15654052547904.e50b2990.jpg" alt=""></p> <p>The end-device sends a “confirmed data” uplink. The network can answer with a confirmed downlink containing Data + ACK + “Frame pending” then the exchange continues as previously described.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/deltacat/lora-docs/edit/master/docs/lorawan-v1.1/ch19.md" target="_blank" rel="noopener noreferrer">帮我改善此页面</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最近更新:</span> <span class="time">9/14/2019, 11:07:50 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/lorawan-v1.1/ch18.html" class="prev">
        第18章 Class C MAC 指令
      </a></span> <span class="next"><a href="/lorawan-v1.1/ch20.html">
        20 Recommendation on contract to be provided to the Network Server by the end-device provider at the time of provisioning
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.741f693f.js" defer></script><script src="/assets/js/2.1bc0aca8.js" defer></script><script src="/assets/js/3.b10d7aa1.js" defer></script>
  </body>
</html>
