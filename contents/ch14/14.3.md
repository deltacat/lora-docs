### 14.3 PingSlotChannnelReq

此指令由服务器发送到终端设备，以修改终端设备期望下行 ping 信号的频率和/或数据速率。

此指令**只能在 Class A 接收窗口中发送**（在上行链路之后）。该指令不能（SHALL NOT）在 Class B ping-slot 中发送。如果设备在 Class B ping-slot 接收到此 MAC 指令，则不应（SHALL NOT）处理该 MAC 指令。

<table>
   <tr>
      <td><b>Octets</b></td>
      <td>3</td>
      <td>1</td>
   </tr>
   <tr>
      <td><b>PingSlotChannelReq Payload</b></td>
      <td>Frequency</td>
      <td>DR</td>
   </tr>
</table>

*Figure 57 : PingSlotChannelReq payload format*

Frequency 字段编码方式和 Class A 中定义的 ***NewChannelReq*** MAC 指令相同。

**Frequency** 是一个 24 位的无符号整数。实际的信标信道频率是 100 x Frequency，单位Hz。信标的信道以 100Hz 为基本单位，变化范围在 100MHz 到 1.67GHz 之间。终端必须检查该频率是不是射频硬件所允许的范围，不是则需要返回错误。

若频率为 0 则表示终端使用默认信标频率计划。

**DR** 字节包含如下字段：

<table>
   <tr>
      <td><b>Bits</b></td>
      <td>[7:4]</td>
      <td>[3:0]</td>
   </tr>
   <tr>
      <td><b>DR</b></td>
      <td>RFU</td>
      <td>data rate</td>
   </tr>
</table>

“数据速率” 子字段是用于ping-slot 下行链路的数据速率的索引。索引和物理数据速率之间的关系在 [PHY-DOC] 中为每个区域定义。

接收到此命令后，终端设备以 ***PingSlotFreqAns*** 消息回应。此消息的 MAC 载荷包含以下信息:

<table>
   <tr>
      <td><b>Size(bytes)</b></td>
      <td>1</td>
   </tr>
   <tr>
      <td><b>pingSlotFreqAns Payload</b></td>
      <td>Status</td>
   </tr>
</table>

*Figure 58 : PingSlotFreqAns payload format*

**Status**各位有以下含义:

<table>
   <tr>
      <td><b>Bits</b></td>
      <td>[7:2]</td>
      <td>1</td>
      <td>0</td>
   </tr>
   <tr>
      <td><b>Status</b></td>
      <td>RFU</td>
      <td>Data rate ok</td>
      <td>Channel frequency ok</td>
   </tr>
</table>

<table>
   <tr>
      <td></td>
      <td><b>Bit = 0</b></td>
      <td><b>Bit = 1</b></td>
   </tr>
   <tr>
      <td><b>Data rate ok</b></td>
      <td>未为该终端设备定义指定的数据速率，保留先前的数据速率</td>
      <td>数据速率与终端设备的可能性兼容</td>
   </tr>
   <tr>
      <td><b>Channel frequency ok</b></td>
      <td>该设备不能以这个频率接收信号</td>
      <td>终端可以使用这个频率</td>
   </tr>
</table>

如果这两个位中有一个等于0，则命令没有成功，ping-slot参数也没有修改。


