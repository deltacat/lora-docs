### 5.13 强制重连指令（***ForceRejoinReq***）


使用强制重连指令，网络要求设备立即发送 Rejoin-Request Type 0 或 Type 2 消息，其中包含可编程的重试次数、周期性和数据速率。这个 RejoinReq 上行通信可以被网络用来立即重设设备密钥或启动切换漫游过程。

此命令包含两字节载荷：

<table class="lora-table">
   <tr>
      <td><b>Bits</b></td>   
      <td>15:14</td>   
      <td>13:11</td>   
      <td>10:8</td>   
      <td>7</td>   
      <td>6:4</td>   
      <td>3:0</td>   
   </tr>
   <tr>
      <td><b>ForceRejoinReq bits</b></td>
      <td>RFU</td>   
      <td>Period</td>   
      <td>Max_Retries</td>   
      <td>RFU</td>   
      <td>RejoinType</td>   
      <td>RFU</td>   
   </tr>
</table>  

*图 40：ForceRejoinReq payload format*

参数按下述方式编码：

Period: 重新传输之间的延迟应等于 （32秒 × 2^Period + Rand32），其中 Rand32 是[0:32]范围内的伪随机数。

Max_Retries: 设备重试 Rejoin-Request 的总次数：

- 0 : Rejoin 仅发送一次（无重试）
- 1 : Rejoin 要（MUST）发送 2 次（1 + 1 重试）
- ……
- 7: Rejoin 要（MUST） 发送 8 times （1 + 7 重试）

RejoinType: 此字段指定应由设备传输的 Rejoin-Request 类型。

- 0 or 1 : A Rejoin-request type 0 shall be transmitted
- 2 : A Rejoin-request type 2 shall be transmitted
- 3 to 7 : RFU

DR: Rejoin-request 帧应（SHALL）使用数据速率 DR 传输。实际物理调制数据速率和 DR 值之间的对应关系遵循与 LinkADRReq 命令相同的约定，并在 [PHY-DOC] 中为每个区域定义。

该命令没有响应，因为设备在收到该命令时必须（MUST）发送一个 Rejoin-Request。RejoinReq 消息的首次发送应在接收到命令后立即进行（但网络可能不会接收到）。如果设备在达到传输重试次数限制之前收到一个新的 ForceRejoinReq 命令，设备应（SHALL）使用新的参数恢复 RejoinReq 的传输。

