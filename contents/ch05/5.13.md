### 5.13 强制重连指令（***ForceRejoinReq***）


使用强制重连指令，网络要求设备立即发送 Rejoin-Request Type 0 或 Type 2 消息，其中包含可编程的重试次数、周期性和数据速率。这个 RejoinReq 上行通信可以被网络用来立即重设设备密钥或启动切换漫游过程。

此命令包含两字节载荷：

<table class="lora-table">
   <tr>
      <td><b>Bits</b></td>   
      <td>15:14</td>   
      <td>13:11</td>   
      <td>10:8</td>   
      <td>7</td>   
      <td>6:4</td>   
      <td>3:0</td>   
   </tr>
   <tr>
      <td><b>ForceRejoinReq bits</b></td>
      <td>RFU</td>   
      <td>Period</td>   
      <td>Max_Retries</td>   
      <td>RFU</td>   
      <td>RejoinType</td>   
      <td>RFU</td>   
   </tr>
</table>  

*图 40：ForceRejoinReq payload format*

参数按下述方式编码：

Period: 重新传输之间的延迟应等于 （32秒 × 2^Period + Rand32），其中 Rand32 是[0:32]范围内的伪随机数。

Max_Retries: 设备重试 Rejoin-Request 的总次数：

- 0 : Rejoin 仅发送一次（无重试）
- 1 : Rejoin 要（MUST）发送 2 次（1 + 1 重试）
- ……
- 7: Rejoin 要（MUST） 发送 8 times （1 + 7 重试）

RejoinType: 此字段指定应由设备传输的 Rejoin-Request 类型。

- 0 or 1 : A Rejoin-request type 0 shall be transmitted
- 2 : A Rejoin-request type 2 shall be transmitted
- 3 to 7 : RFU

DR: The Rejoin-request frame SHALL be transmitted using the data rate DR. The correspondence between the actual physical modulation data rate and the DR value follows the same convention as the LinkADRReq command and is defined for each region in [PHY]

The command has no answer, as the device MUST send a Rejoin-Request when receiving the command. The first transmission of a RejoinReq message SHALL be done immediately after the reception of the command (but the network may not receive it). If the device receives a new ForceRejoinReq command before it has reached the number of transmission retries, the device SHALL resume transmission of RejoinReq with the new parameters.

